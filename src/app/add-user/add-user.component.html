<div class="card flex justify-center mt-4">
    <p-selectbutton size="large" styleClass="w-full" [options]="stateOptions" [(ngModel)]="selectedState" optionLabel="label" optionValue="value" aria-labelledby="basic" (onChange)="onStateChange()"/>
</div>
<div *ngIf="selectedState === 'import'">
    <p class="text-center mt-4">Please upload a file in the format of .xls or .xlsx</p>
    <div class="flex justify-center">
        <div class="mt-4 w-[360px] p-3 bg-blue-50 rounded-lg border border-blue-200">
            <p class="text-sm font-semibold text-blue-800 mb-2">Required Excel Columns:</p>
            <p class="text-xs text-blue-700">
                <strong>Required:</strong> ucIdNumber, firstName, lastName, email<br>
                <strong>Optional:</strong> middleName, extName, sex, phoneNumber, maritalStatus, userRoles (comma-separated)
            </p>
            <p class="text-xs text-blue-600 mt-1 mt-4">
                <em>Note: Passwords will be auto-generated (8 characters) and users will be set to first login.</em>
            </p>
        </div>
    </div>

    <div class="flex justify-center mt-4">
        <p-button (click)="downloadExcelTemplate()" label="Download Excel Template" icon="pi pi-download" link ></p-button>
    </div>
    
    <div class="mt-6">
        <p-fileupload mode="basic" name="demo[]" chooseIcon="pi pi-upload" 
        accept=".xls,.xlsx,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        maxFileSize="10000000" (onSelect)="onBasicUploadAuto($event)" 
        chooseLabel="Upload Excel File" [disabled]="isProcessing" />
    </div>
    
    <div *ngIf="isProcessing" class="mt-4">
        <div class="text-center mb-2">
            <p class="font-semibold">{{processingStatus}}</p>
        </div>
        <p-progressbar [value]="processingProgress" [showValue]="true"></p-progressbar>
    </div>
    
    <div *ngIf="!isProcessing && processingProgress === 100" class="mt-4 text-center">
        <p class="text-green-600 font-semibold">âœ“ Import completed successfully!</p>
        <div *ngIf="showDownloadButton" class="mt-3">
            <button 
                pButton 
                type="button" 
                label="Download Users Excel" 
                icon="pi pi-download" 
                class="p-button-success"
                (click)="downloadImportedUsersExcel()">
            </button>
            <p class="text-xs text-gray-600 mt-2">
                Download contains: Complete Name, UC ID Number, Password (unencrypted), Email
            </p>
        </div>
    </div>
</div>